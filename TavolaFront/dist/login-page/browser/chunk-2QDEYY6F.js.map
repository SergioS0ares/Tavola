{
  "version": 3,
  "sources": ["src/app/core/services/restaurante.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable, of, BehaviorSubject } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\nimport { IRestaurante } from '../../Interfaces/IRestaurante.interface';\r\nimport { map, tap } from 'rxjs/operators';\r\n\r\nexport interface IUpdateRestaurantePayload {\r\n  tipoCozinha?: string;\r\n  descricao?: string;\r\n  horariosFuncionamento?: { diaSemana: string; abertura: string; fechamento: string }[];\r\n  nomesServicos?: string[];\r\n  imagens?: string[];\r\n  \r\n  // Campos de usuário para atualização de restaurante\r\n  nomeUsuario?: string;\r\n  emailUsuario?: string;\r\n  senhaUsuario?: string;\r\n  telefoneUsuario?: string;\r\n  enderecoUsuario?: {\r\n    cep: string;\r\n    estado: string;\r\n    cidade: string;\r\n    bairro: string;\r\n    rua: string;\r\n    numero: string;\r\n    complemento?: string;\r\n  };\r\n}\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class RestauranteService {\r\n  private http = inject(HttpClient);\r\n  // URL base da sua API, pode vir do environment\r\n  private apiUrl = `${environment.apiUrl}/auth/restaurantes`;\r\n\r\n  // NEW: BehaviorSubjects for centralized data\r\n  private _allRestaurants = new BehaviorSubject<IRestaurante[]>([]);\r\n  public allRestaurants$: Observable<IRestaurante[]> = this._allRestaurants.asObservable();\r\n\r\n  private _allCities = new BehaviorSubject<string[]>([]);\r\n  public allCities$: Observable<string[]> = this._allCities.asObservable();\r\n\r\n  private _allCuisines = new BehaviorSubject<string[]>([]);\r\n  public allCuisines$: Observable<string[]> = this._allCuisines.asObservable();\r\n\r\n  constructor() {\r\n    // Initial fetch of restaurants to populate subjects\r\n    // This ensures data is loaded when the service is instantiated\r\n    this.getRestaurantes().subscribe(); \r\n  }\r\n\r\n  // Helper to process restaurant data and update subjects\r\n  private processAndSetRestaurantData(restaurants: IRestaurante[]): void {\r\n    this._allRestaurants.next(restaurants);\r\n\r\n    const citiesSet = new Set<string>();\r\n    const cuisinesSet = new Set<string>();\r\n\r\n    restaurants.forEach(r => {\r\n      if (r.endereco?.cidade) { \r\n        citiesSet.add(r.endereco.cidade); // Only city, as per user request\r\n      }\r\n      if (r.tipoCozinha) {\r\n        cuisinesSet.add(r.tipoCozinha);\r\n      }\r\n    });\r\n\r\n    this._allCities.next(Array.from(citiesSet).sort());\r\n    // Adjusted to only emit fetched cuisines\r\n    this._allCuisines.next(Array.from(cuisinesSet).sort());\r\n  }\r\n\r\n  getRestaurantes(): Observable<IRestaurante[]> {\r\n    // Use tap to update BehaviorSubject after fetching\r\n    return this.http.get<IRestaurante[]>(this.apiUrl).pipe(\r\n      tap(restaurants => this.processAndSetRestaurantData(restaurants))\r\n    );\r\n  }\r\n\r\n  findById(id: string): Observable<IRestaurante> {\r\n    return this.http.get<IRestaurante>(`${this.apiUrl}/${id}`);\r\n  }\r\n\r\n  getRestaurantImages(id: string): Observable<string[]> {\r\n    return of(['assets/jpg/restauranteModelo.jpg', 'assets/jpg/restauranteModelo.jpg', 'assets/jpg/restauranteModelo.jpg']);\r\n  }\r\n\r\n  criarReserva(reservaData: any): Observable<any> {\r\n    console.log('Mock: Criando reserva com dados:', reservaData);\r\n    return of({ success: true, message: 'Reserva mock criada com sucesso!' });\r\n  }\r\n\r\n  favoritarRestaurante(id: string) {\r\n    return this.http.post(`${this.apiUrl.replace('/auth/restaurantes','/auth/clientes/favoritar')}/${id}`, {});\r\n  }\r\n\r\n  updateRestaurante(payload: IUpdateRestaurantePayload): Observable<any> {\r\n    return this.http.put(`${this.apiUrl}/update`, payload);\r\n  }\r\n\r\n  deleteRestaurante(): Observable<any> {\r\n    return this.http.delete(`${this.apiUrl}`);\r\n  }\r\n\r\n  getRestaurantesPorCidade(cidade: string): Observable<IRestaurante[]> {\r\n    return this.http.get<IRestaurante[]>(`${this.apiUrl}/por-cidade?cidade=${cidade}`);\r\n  }\r\n\r\n  getPesquisarRestaurantes(termo: string, pagina: number = 0, tamanho: number = 10): Observable<any> {\r\n    return this.http.get<any>(`${this.apiUrl}/pesquisar?termo=${termo}&pagina=${pagina}&tamanho=${tamanho}`);\r\n  }\r\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;AA+BM,IAAO,qBAAP,MAAO,oBAAkB;EAe7B,cAAA;AAdQ,SAAA,OAAO,OAAO,UAAU;AAExB,SAAA,SAAS,GAAG,YAAY,MAAM;AAG9B,SAAA,kBAAkB,IAAI,gBAAgC,CAAA,CAAE;AACzD,SAAA,kBAA8C,KAAK,gBAAgB,aAAY;AAE9E,SAAA,aAAa,IAAI,gBAA0B,CAAA,CAAE;AAC9C,SAAA,aAAmC,KAAK,WAAW,aAAY;AAE9D,SAAA,eAAe,IAAI,gBAA0B,CAAA,CAAE;AAChD,SAAA,eAAqC,KAAK,aAAa,aAAY;AAKxE,SAAK,gBAAe,EAAG,UAAS;EAClC;;EAGQ,4BAA4B,aAA2B;AAC7D,SAAK,gBAAgB,KAAK,WAAW;AAErC,UAAM,YAAY,oBAAI,IAAG;AACzB,UAAM,cAAc,oBAAI,IAAG;AAE3B,gBAAY,QAAQ,OAAI;AACtB,UAAI,EAAE,UAAU,QAAQ;AACtB,kBAAU,IAAI,EAAE,SAAS,MAAM;MACjC;AACA,UAAI,EAAE,aAAa;AACjB,oBAAY,IAAI,EAAE,WAAW;MAC/B;IACF,CAAC;AAED,SAAK,WAAW,KAAK,MAAM,KAAK,SAAS,EAAE,KAAI,CAAE;AAEjD,SAAK,aAAa,KAAK,MAAM,KAAK,WAAW,EAAE,KAAI,CAAE;EACvD;EAEA,kBAAe;AAEb,WAAO,KAAK,KAAK,IAAoB,KAAK,MAAM,EAAE,KAChD,IAAI,iBAAe,KAAK,4BAA4B,WAAW,CAAC,CAAC;EAErE;EAEA,SAAS,IAAU;AACjB,WAAO,KAAK,KAAK,IAAkB,GAAG,KAAK,MAAM,IAAI,EAAE,EAAE;EAC3D;EAEA,oBAAoB,IAAU;AAC5B,WAAO,GAAG,CAAC,oCAAoC,oCAAoC,kCAAkC,CAAC;EACxH;EAEA,aAAa,aAAgB;AAC3B,YAAQ,IAAI,oCAAoC,WAAW;AAC3D,WAAO,GAAG,EAAE,SAAS,MAAM,SAAS,mCAAkC,CAAE;EAC1E;EAEA,qBAAqB,IAAU;AAC7B,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,OAAO,QAAQ,sBAAqB,0BAA0B,CAAC,IAAI,EAAE,IAAI,CAAA,CAAE;EAC3G;EAEA,kBAAkB,SAAkC;AAClD,WAAO,KAAK,KAAK,IAAI,GAAG,KAAK,MAAM,WAAW,OAAO;EACvD;EAEA,oBAAiB;AACf,WAAO,KAAK,KAAK,OAAO,GAAG,KAAK,MAAM,EAAE;EAC1C;EAEA,yBAAyB,QAAc;AACrC,WAAO,KAAK,KAAK,IAAoB,GAAG,KAAK,MAAM,sBAAsB,MAAM,EAAE;EACnF;EAEA,yBAAyB,OAAe,SAAiB,GAAG,UAAkB,IAAE;AAC9E,WAAO,KAAK,KAAK,IAAS,GAAG,KAAK,MAAM,oBAAoB,KAAK,WAAW,MAAM,YAAY,OAAO,EAAE;EACzG;;;uCAhFW,qBAAkB;IAAA;EAAA;;4EAAlB,qBAAkB,SAAlB,oBAAkB,WAAA,YADL,OAAM,CAAA;EAAA;;;sEACnB,oBAAkB,CAAA;UAD9B;WAAW,EAAE,YAAY,OAAM,CAAE;;;",
  "names": []
}
