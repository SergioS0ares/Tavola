{
  "version": 3,
  "sources": ["src/app/pages/acesso/login/login.component.ts", "src/app/pages/acesso/login/login.component.html"],
  "sourcesContent": ["import { Component, inject } from '@angular/core';\r\nimport { DefaultLoginLayoutComponent } from '../default-login-layout/default-login-layout.component';\r\nimport { FormControl, FormGroup, ReactiveFormsModule, Validators, AbstractControl, ValidationErrors } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { LoginService } from '../../../core/services/login.service';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ILoginForm } from '../../../Interfaces/ILoginForm.interface';\r\nimport { AuthService } from '../../../core/services/auth.service';\r\nimport { NzIconModule } from 'ng-zorro-antd/icon';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    DefaultLoginLayoutComponent,\r\n    ReactiveFormsModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    NzIconModule\r\n  ],\r\n  providers: [],\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.scss']\r\n})\r\nexport class LoginComponent {\r\n  loginForm: FormGroup<ILoginForm>;\r\n  showForgotInfo = false;\r\n  showLoginError = false;\r\n\r\n  // Nova forma de injeção no Angular 19\r\n  private router = inject(Router);\r\n  private loginService = inject(LoginService);\r\n  private toastService = inject(ToastrService);\r\n  private authService = inject(AuthService);\r\n\r\n  constructor() {\r\n    this.loginForm = new FormGroup<ILoginForm>({\r\n      email: new FormControl<string>('', {\r\n        nonNullable: true,\r\n        validators: [Validators.required, Validators.email]\r\n      }),\r\n      senha: new FormControl<string>('', {\r\n        nonNullable: true,\r\n        validators: [Validators.required]\r\n      })\r\n    });\r\n  }\r\n  emailWithTLDValidator(control: AbstractControl): ValidationErrors | null {\r\n    const value = control.value as string;\r\n    // Regex para verificar se o e-mail termina com um TLD válido\r\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/;\r\n    if (value && !regex.test(value)) {\r\n      return { emailTLD: true };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  realizarLogin(){\r\n    if (this.loginForm.invalid) {\r\n      this.loginForm.markAllAsTouched();\r\n      return;\r\n    }\r\n\r\n    const email = this.loginForm.get('email')?.value;\r\n    const senha = this.loginForm.get('senha')?.value;\r\n\r\n    if (email && senha) {\r\n      this.loginService.login(email, senha).subscribe({\r\n        next: (res) => {\r\n          this.showLoginError = false;\r\n          // Centraliza o armazenamento no AuthService       \r\n          this.toastService.success(\"Login feito com sucesso!\");\r\n          \r\n          if (res.tipoUsuario === 'RESTAURANTE') {\r\n            this.authService.setAuthData(res.token, res.nome, res.tipoUsuario as 'CLIENTE' | 'RESTAURANTE', res.id, res.imagem);\r\n            this.router.navigate(['reserva']);\r\n          } else {\r\n            this.router.navigate(['home']);\r\n          }\r\n        },\r\n        error: (err) => {\r\n          this.showLoginError = true;\r\n          const errorMessage = err.error?.message || \"Não foi possível acessar sua conta. Verifique seu e-mail e senha e tente novamente.\";\r\n          this.toastService.error(errorMessage);\r\n        }\r\n      });\r\n    } else {\r\n      this.showLoginError = true;\r\n      this.toastService.error(\"Email ou senha inválidos.\");\r\n    }\r\n  }\r\n\r\n  irParaCadastro(){\r\n    this.router.navigate([\"signup\"]);\r\n  }\r\n\r\n  forgotPassword(){\r\n    this.showForgotInfo = true;\r\n    this.toastService.info(\"Funcionalidade de recuperação de senha ainda não implementada.\");\r\n  }\r\n}\r\n", "<app-default-login-layout>\r\n\r\n    <div class=\"form-section\">\r\n        <form [formGroup]=\"loginForm\" class=\"login-form\" (ngSubmit)=\"realizarLogin()\">\r\n            <!-- Campo E-mail -->\r\n            <mat-form-field class=\"largura-total\" appearance=\"outline\" >\r\n                <mat-label>E-mail</mat-label>\r\n                <span matPrefix>\r\n                    <mat-icon class=\"input-icon\">email</mat-icon>\r\n                </span>\r\n                <input matInput placeholder=\"Seu e-mail\" formControlName=\"email\" type=\"email\">\r\n\r\n                <!-- Priorizar o erro do TLD antes do erro padrão -->\r\n                <mat-error *ngIf=\"loginForm.get('email')?.hasError('emailTLD')\">\r\n                    Insira um email válido com um domínio (ex: .com)\r\n                </mat-error>\r\n                <mat-error *ngIf=\"loginForm.get('email')?.hasError('email') && !loginForm.get('email')?.hasError('emailTLD')\">\r\n                    Email inválido\r\n                </mat-error>\r\n                <mat-error *ngIf=\"loginForm.get('email')?.hasError('required') && !loginForm.get('email')?.hasError('emailTLD') && !loginForm.get('email')?.hasError('email')\">\r\n                    Este campo é obrigatório\r\n                </mat-error>\r\n            </mat-form-field>\r\n\r\n            <!-- Campo Senha -->\r\n            <mat-form-field class=\"largura-total\" appearance=\"outline\">\r\n                <mat-label>Senha</mat-label>\r\n                <span matPrefix>\r\n                    <mat-icon class=\"input-icon\">lock</mat-icon>\r\n                </span>\r\n                <input matInput placeholder=\"Sua senha\" formControlName=\"senha\" type=\"password\">\r\n                <mat-error *ngIf=\"loginForm.get('senha')?.hasError('required')\">\r\n                    Este campo é obrigatório\r\n                </mat-error>\r\n            </mat-form-field>\r\n            <!-- Link Esqueci Minha Senha -->\r\n            <div class=\"forgot-password\">\r\n                <a href=\"#\" (click)=\"forgotPassword(); $event.preventDefault();\">Esqueci minha senha</a>\r\n                <span *ngIf=\"showForgotInfo\" class=\"not-ready\">Funcionalidade ainda não implementada.</span>\r\n            </div>\r\n            <div *ngIf=\"showLoginError\" class=\"login-error-card\">\r\n                <mat-icon>error</mat-icon>\r\n                Não foi possível acessar sua conta. Verifique seu e-mail e senha e tente novamente.\r\n            </div>\r\n            <div class=\"actions\">\r\n                <button \r\n                  type=\"submit\" \r\n                  class=\"primary-action\" \r\n                  [disabled]=\"!loginForm.valid\">\r\n                  <i nz-icon nzType=\"login\" nzTheme=\"outline\"></i>\r\n                  Entrar\r\n                </button>\r\n                \r\n                <button \r\n                  type=\"button\"\r\n                  class=\"secondary-action\" \r\n                  (click)=\"irParaCadastro()\">\r\n                  <i nz-icon nzType=\"user-add\" nzTheme=\"outline\"></i>\r\n                  Criar Conta\r\n                </button>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</app-default-login-layout>\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACagB,IAAA,yBAAA,GAAA,WAAA;AACI,IAAA,iBAAA,GAAA,0DAAA;AACJ,IAAA,uBAAA;;;;;AACA,IAAA,yBAAA,GAAA,WAAA;AACI,IAAA,iBAAA,GAAA,qBAAA;AACJ,IAAA,uBAAA;;;;;AACA,IAAA,yBAAA,GAAA,WAAA;AACI,IAAA,iBAAA,GAAA,kCAAA;AACJ,IAAA,uBAAA;;;;;AAUA,IAAA,yBAAA,GAAA,WAAA;AACI,IAAA,iBAAA,GAAA,kCAAA;AACJ,IAAA,uBAAA;;;;;AAKA,IAAA,yBAAA,GAAA,QAAA,EAAA;AAA+C,IAAA,iBAAA,GAAA,2CAAA;AAAsC,IAAA,uBAAA;;;;;AAEzF,IAAA,yBAAA,GAAA,OAAA,EAAA,EAAqD,GAAA,UAAA;AACvC,IAAA,iBAAA,GAAA,OAAA;AAAK,IAAA,uBAAA;AACf,IAAA,iBAAA,GAAA,6FAAA;AACJ,IAAA,uBAAA;;;ADXN,IAAO,iBAAP,MAAO,gBAAc;EAWzB,cAAA;AATA,SAAA,iBAAiB;AACjB,SAAA,iBAAiB;AAGT,SAAA,SAAS,OAAO,MAAM;AACtB,SAAA,eAAe,OAAO,YAAY;AAClC,SAAA,eAAe,OAAO,aAAa;AACnC,SAAA,cAAc,OAAO,WAAW;AAGtC,SAAK,YAAY,IAAI,UAAsB;MACzC,OAAO,IAAI,YAAoB,IAAI;QACjC,aAAa;QACb,YAAY,CAAC,WAAW,UAAU,WAAW,KAAK;OACnD;MACD,OAAO,IAAI,YAAoB,IAAI;QACjC,aAAa;QACb,YAAY,CAAC,WAAW,QAAQ;OACjC;KACF;EACH;EACA,sBAAsB,SAAwB;AAC5C,UAAM,QAAQ,QAAQ;AAEtB,UAAM,QAAQ;AACd,QAAI,SAAS,CAAC,MAAM,KAAK,KAAK,GAAG;AAC/B,aAAO,EAAE,UAAU,KAAI;IACzB;AACA,WAAO;EACT;EAEA,gBAAa;AACX,QAAI,KAAK,UAAU,SAAS;AAC1B,WAAK,UAAU,iBAAgB;AAC/B;IACF;AAEA,UAAM,QAAQ,KAAK,UAAU,IAAI,OAAO,GAAG;AAC3C,UAAM,QAAQ,KAAK,UAAU,IAAI,OAAO,GAAG;AAE3C,QAAI,SAAS,OAAO;AAClB,WAAK,aAAa,MAAM,OAAO,KAAK,EAAE,UAAU;QAC9C,MAAM,CAAC,QAAO;AACZ,eAAK,iBAAiB;AAEtB,eAAK,aAAa,QAAQ,0BAA0B;AAEpD,cAAI,IAAI,gBAAgB,eAAe;AACrC,iBAAK,YAAY,YAAY,IAAI,OAAO,IAAI,MAAM,IAAI,aAA0C,IAAI,IAAI,IAAI,MAAM;AAClH,iBAAK,OAAO,SAAS,CAAC,SAAS,CAAC;UAClC,OAAO;AACL,iBAAK,OAAO,SAAS,CAAC,MAAM,CAAC;UAC/B;QACF;QACA,OAAO,CAAC,QAAO;AACb,eAAK,iBAAiB;AACtB,gBAAM,eAAe,IAAI,OAAO,WAAW;AAC3C,eAAK,aAAa,MAAM,YAAY;QACtC;OACD;IACH,OAAO;AACL,WAAK,iBAAiB;AACtB,WAAK,aAAa,MAAM,8BAA2B;IACrD;EACF;EAEA,iBAAc;AACZ,SAAK,OAAO,SAAS,CAAC,QAAQ,CAAC;EACjC;EAEA,iBAAc;AACZ,SAAK,iBAAiB;AACtB,SAAK,aAAa,KAAK,yEAAgE;EACzF;;;uCA3EW,iBAAc;IAAA;EAAA;;yEAAd,iBAAc,WAAA,CAAA,CAAA,WAAA,CAAA,GAAA,UAAA,CAAA,6BAJd,CAAA,CAAE,CAAA,GAAA,OAAA,IAAA,MAAA,GAAA,QAAA,CAAA,CAAA,GAAA,cAAA,GAAA,CAAA,GAAA,cAAA,GAAA,YAAA,WAAA,GAAA,CAAA,cAAA,WAAA,GAAA,eAAA,GAAA,CAAA,aAAA,EAAA,GAAA,CAAA,GAAA,YAAA,GAAA,CAAA,YAAA,IAAA,eAAA,cAAA,mBAAA,SAAA,QAAA,OAAA,GAAA,CAAA,GAAA,MAAA,GAAA,CAAA,YAAA,IAAA,eAAA,aAAA,mBAAA,SAAA,QAAA,UAAA,GAAA,CAAA,GAAA,iBAAA,GAAA,CAAA,QAAA,KAAA,GAAA,OAAA,GAAA,CAAA,SAAA,aAAA,GAAA,MAAA,GAAA,CAAA,SAAA,oBAAA,GAAA,MAAA,GAAA,CAAA,GAAA,SAAA,GAAA,CAAA,QAAA,UAAA,GAAA,kBAAA,GAAA,UAAA,GAAA,CAAA,WAAA,IAAA,UAAA,SAAA,WAAA,SAAA,GAAA,CAAA,QAAA,UAAA,GAAA,oBAAA,GAAA,OAAA,GAAA,CAAA,WAAA,IAAA,UAAA,YAAA,WAAA,SAAA,GAAA,CAAA,GAAA,WAAA,GAAA,CAAA,GAAA,kBAAA,CAAA,GAAA,UAAA,SAAA,wBAAA,IAAA,KAAA;AAAA,UAAA,KAAA,GAAA;AC5Bf,QAAA,yBAAA,GAAA,0BAAA,EAA0B,GAAA,OAAA,CAAA,EAEI,GAAA,QAAA,CAAA;AAC2B,QAAA,qBAAA,YAAA,SAAA,mDAAA;AAAA,iBAAY,IAAA,cAAA;QAAe,CAAA;AAExE,QAAA,yBAAA,GAAA,kBAAA,CAAA,EAA4D,GAAA,WAAA;AAC7C,QAAA,iBAAA,GAAA,QAAA;AAAM,QAAA,uBAAA;AACjB,QAAA,yBAAA,GAAA,QAAA,CAAA,EAAgB,GAAA,YAAA,CAAA;AACiB,QAAA,iBAAA,GAAA,OAAA;AAAK,QAAA,uBAAA,EAAW;AAEjD,QAAA,oBAAA,GAAA,SAAA,CAAA;AAGA,QAAA,qBAAA,IAAA,sCAAA,GAAA,GAAA,aAAA,CAAA,EAAgE,IAAA,sCAAA,GAAA,GAAA,aAAA,CAAA,EAG8C,IAAA,sCAAA,GAAA,GAAA,aAAA,CAAA;AAMlH,QAAA,uBAAA;AAGA,QAAA,yBAAA,IAAA,kBAAA,CAAA,EAA2D,IAAA,WAAA;AAC5C,QAAA,iBAAA,IAAA,OAAA;AAAK,QAAA,uBAAA;AAChB,QAAA,yBAAA,IAAA,QAAA,CAAA,EAAgB,IAAA,YAAA,CAAA;AACiB,QAAA,iBAAA,IAAA,MAAA;AAAI,QAAA,uBAAA,EAAW;AAEhD,QAAA,oBAAA,IAAA,SAAA,CAAA;AACA,QAAA,qBAAA,IAAA,sCAAA,GAAA,GAAA,aAAA,CAAA;AAGJ,QAAA,uBAAA;AAEA,QAAA,yBAAA,IAAA,OAAA,CAAA,EAA6B,IAAA,KAAA,CAAA;AACb,QAAA,qBAAA,SAAA,SAAA,4CAAA,QAAA;AAAS,cAAA,eAAA;AAAgB,iBAAE,OAAA,eAAA;QAAuB,CAAA;AAAG,QAAA,iBAAA,IAAA,qBAAA;AAAmB,QAAA,uBAAA;AACpF,QAAA,qBAAA,IAAA,iCAAA,GAAA,GAAA,QAAA,EAAA;AACJ,QAAA,uBAAA;AACA,QAAA,qBAAA,IAAA,gCAAA,GAAA,GAAA,OAAA,EAAA;AAIA,QAAA,yBAAA,IAAA,OAAA,EAAA,EAAqB,IAAA,UAAA,EAAA;AAKf,QAAA,oBAAA,IAAA,KAAA,EAAA;AACA,QAAA,iBAAA,IAAA,UAAA;AACF,QAAA,uBAAA;AAEA,QAAA,yBAAA,IAAA,UAAA,EAAA;AAGE,QAAA,qBAAA,SAAA,SAAA,mDAAA;AAAA,iBAAS,IAAA,eAAA;QAAgB,CAAA;AACzB,QAAA,oBAAA,IAAA,KAAA,EAAA;AACA,QAAA,iBAAA,IAAA,eAAA;AACF,QAAA,uBAAA,EAAS,EACP,EACH,EACL;;;;;;;AA3DI,QAAA,oBAAA,CAAA;AAAA,QAAA,qBAAA,aAAA,IAAA,SAAA;AAUc,QAAA,oBAAA,CAAA;AAAA,QAAA,qBAAA,SAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,UAAA,CAAA;AAGA,QAAA,oBAAA;AAAA,QAAA,qBAAA,UAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,OAAA,MAAA,GAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,UAAA,EAAA;AAGA,QAAA,oBAAA;AAAA,QAAA,qBAAA,UAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,UAAA,MAAA,GAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,UAAA,MAAA,GAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,OAAA,EAAA;AAYA,QAAA,oBAAA,CAAA;AAAA,QAAA,qBAAA,SAAA,UAAA,IAAA,UAAA,IAAA,OAAA,MAAA,OAAA,OAAA,QAAA,SAAA,UAAA,CAAA;AAOL,QAAA,oBAAA,CAAA;AAAA,QAAA,qBAAA,QAAA,IAAA,cAAA;AAEL,QAAA,oBAAA;AAAA,QAAA,qBAAA,QAAA,IAAA,cAAA;AAQA,QAAA,oBAAA,CAAA;AAAA,QAAA,qBAAA,YAAA,CAAA,IAAA,UAAA,KAAA;;;MD7Bd;MAAY;MACZ;MACA;MAAmB;MAAA;MAAA;MAAA;MAAA;MAAA;MACnB;MAAkB;MAAA;MAAA;MAAA;MAClB;MAAc;MACd;MAAa;MACb;MACA;MAAY;IAAA,GAAA,QAAA,CAAA,qzQAAA,EAAA,CAAA;EAAA;;;sEAMH,gBAAc,CAAA;UAjB1B;uBACW,aAAW,YACT,MAAI,SACP;MACP;MACA;MACA;MACA;MACA;MACA;MACA;MACA;OACD,WACU,CAAA,GAAE,UAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAAA,QAAA,CAAA,6qNAAA,EAAA,CAAA;;;;6EAIF,gBAAc,EAAA,WAAA,kBAAA,UAAA,iDAAA,YAAA,GAAA,CAAA;AAAA,GAAA;",
  "names": []
}
