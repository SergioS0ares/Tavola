{
  "version": 3,
  "sources": ["src/app/core/services/maps.service.ts"],
  "sourcesContent": ["// src/app/core/services/maps.service.ts\r\nimport { Injectable } from \"@angular/core\"\r\nimport { HttpClient } from \"@angular/common/http\"\r\nimport { Observable , Observer} from \"rxjs\"\r\nimport { map } from \"rxjs/operators\"\r\n\r\n@Injectable({\r\n  providedIn: \"root\",\r\n})\r\nexport class MapsService {\r\n\r\n  private geocoder: google.maps.Geocoder;\r\n\r\n  constructor(private http: HttpClient) {\r\n    this.geocoder = new google.maps.Geocoder();\r\n  }\r\n  \r\n\r\n  private googleMapsApiKey = 'AIzaSyCUDeZfumwzHU8nU1iPvX2s6C0tAZYEaxQ';\r\n\r\n  public getCoordinatesFromAddress(address: string): Observable<{ lat: number; lng: number }> {\r\n    return new Observable((observer: Observer<{ lat: number; lng: number }>) => {\r\n      this.geocoder.geocode({ address: address }, (results, status) => {\r\n        if (status === google.maps.GeocoderStatus.OK && results && results[0]) {\r\n          const location = results[0].geometry.location;\r\n          // Emite o resultado com sucesso\r\n          observer.next({ lat: location.lat(), lng: location.lng() });\r\n          observer.complete();\r\n        } else {\r\n          // Emite um erro se a conversão falhar\r\n          observer.error(`A geocodificação falhou pelo seguinte motivo: ${status}`);\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  async mostrarRotaNoGoogleMaps(destino: { lat: number; lng: number }): Promise<void> {\r\n    try {\r\n      const origem = await this.obterLocalizacaoAtual();\r\n      this.abrirGoogleMapsComRota(origem, destino);\r\n    } catch (error) {\r\n      console.warn(\"Não foi possível obter a localização atual. Usando origem padrão (Goiânia).\");\r\n      const origemPadrao = { lat: -16.6869, lng: -49.2648 }; // Goiânia\r\n      this.abrirGoogleMapsComRota(origemPadrao, destino);\r\n    }\r\n  }\r\n\r\n  private obterLocalizacaoAtual(): Promise<{ lat: number; lng: number }> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!navigator.geolocation) {\r\n        return reject(\"Geolocalização não é suportada pelo navegador.\");\r\n      }\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => resolve({\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        }),\r\n        () => reject(\"Erro ao obter localização.\"),\r\n        { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\r\n      );\r\n    });\r\n  }\r\n\r\n  // **MÉTODO CORRIGIDO PARA ABRIR O MAPS**\r\n  private abrirGoogleMapsComRota(origem: { lat: number; lng: number }, destino: { lat: number; lng: number }): void {\r\n    // CORREÇÃO: Usando o formato de URL padrão e mais robusto do Google Maps.\r\n    const url = `https://www.google.com/maps/dir/?api=1&origin=${origem.lat},${origem.lng}&destination=${destino.lat},${destino.lng}&travelmode=driving`;\r\n    window.open(url, \"_blank\");\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;AASM,IAAO,cAAP,MAAO,aAAW;EAItB,YAAoB,MAAgB;AAAhB,SAAA,OAAA;AAKZ,SAAA,mBAAmB;AAJzB,SAAK,WAAW,IAAI,OAAO,KAAK,SAAQ;EAC1C;EAKO,0BAA0B,SAAe;AAC9C,WAAO,IAAI,WAAW,CAAC,aAAoD;AACzE,WAAK,SAAS,QAAQ,EAAE,QAAgB,GAAI,CAAC,SAAS,WAAU;AAC9D,YAAI,WAAW,OAAO,KAAK,eAAe,MAAM,WAAW,QAAQ,CAAC,GAAG;AACrE,gBAAM,WAAW,QAAQ,CAAC,EAAE,SAAS;AAErC,mBAAS,KAAK,EAAE,KAAK,SAAS,IAAG,GAAI,KAAK,SAAS,IAAG,EAAE,CAAE;AAC1D,mBAAS,SAAQ;QACnB,OAAO;AAEL,mBAAS,MAAM,uDAAiD,MAAM,EAAE;QAC1E;MACF,CAAC;IACH,CAAC;EACH;EAEM,wBAAwB,SAAqC;;AACjE,UAAI;AACF,cAAM,SAAS,MAAM,KAAK,sBAAqB;AAC/C,aAAK,uBAAuB,QAAQ,OAAO;MAC7C,SAAS,OAAO;AACd,gBAAQ,KAAK,+FAA6E;AAC1F,cAAM,eAAe,EAAE,KAAK,UAAU,KAAK,SAAQ;AACnD,aAAK,uBAAuB,cAAc,OAAO;MACnD;IACF;;EAEQ,wBAAqB;AAC3B,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAU;AACrC,UAAI,CAAC,UAAU,aAAa;AAC1B,eAAO,OAAO,4DAAgD;MAChE;AACA,gBAAU,YAAY,mBACpB,CAAC,aAAa,QAAQ;QACpB,KAAK,SAAS,OAAO;QACrB,KAAK,SAAS,OAAO;OACtB,GACD,MAAM,OAAO,kCAA4B,GACzC,EAAE,oBAAoB,MAAM,SAAS,KAAO,YAAY,EAAC,CAAE;IAE/D,CAAC;EACH;;EAGQ,uBAAuB,QAAsC,SAAqC;AAExG,UAAM,MAAM,iDAAiD,OAAO,GAAG,IAAI,OAAO,GAAG,gBAAgB,QAAQ,GAAG,IAAI,QAAQ,GAAG;AAC/H,WAAO,KAAK,KAAK,QAAQ;EAC3B;;;uCA3DW,cAAW,mBAAA,UAAA,CAAA;IAAA;EAAA;;4EAAX,cAAW,SAAX,aAAW,WAAA,YAFV,OAAM,CAAA;EAAA;;;sEAEP,aAAW,CAAA;UAHvB;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
