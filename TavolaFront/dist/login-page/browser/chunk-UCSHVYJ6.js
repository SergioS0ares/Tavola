import{a as p}from"./chunk-RKU5BQ3S.js";import{D as h}from"./chunk-KZ2VZQWD.js";import{da as r,ha as n,ma as s}from"./chunk-ZBUSQTZT.js";var u=(()=>{class e{constructor(t,i){this.httpClient=t,this.auth=i,this.apiUrl="http://localhost:8080/auth"}login(t,i){return this.httpClient.post(`${this.apiUrl}/login`,{email:t,senha:i},{withCredentials:!0}).pipe(r(o=>{this.auth.setToken(o.token),this.auth.setPerfil({tipo:o.tipoUsuario,nome:o.nome,imagem:o.imagem})}))}signup(t){return this.httpClient.post(`${this.apiUrl}/register`,t,{withCredentials:!0}).pipe(r(i=>{this.auth.setToken(i.token),this.auth.setPerfil({tipo:i.tipoUsuario,nome:i.nome,imagem:i.imagem})}))}refreshToken(){return console.log("[LoginService] calling /auth/refresh"),this.httpClient.post(`${this.apiUrl}/refresh`,{},{withCredentials:!0}).pipe(r(t=>{console.log("[LoginService] refresh response received:",t),this.auth.setToken(t.token),this.auth.setPerfil({tipo:t.tipoUsuario,nome:t.nome,imagem:t.imagem})}))}static{this.\u0275fac=function(i){return new(i||e)(s(h),s(p))}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{u as a};
