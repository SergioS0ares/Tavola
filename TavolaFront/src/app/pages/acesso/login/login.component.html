<app-default-login-layout>

    <div class="form-section">
        <form [formGroup]="loginForm" class="login-form" (ngSubmit)="realizarLogin()">
            <!-- Campo E-mail -->
            <mat-form-field class="largura-total" appearance="outline" >
                <mat-label>E-mail</mat-label>
                <span matPrefix>
                    <mat-icon class="input-icon">email</mat-icon>
                </span>
                <input matInput placeholder="Seu e-mail" formControlName="email" type="email">

                <!-- Priorizar o erro do TLD antes do erro padrão -->
                <mat-error *ngIf="loginForm.get('email')?.hasError('emailTLD')">
                    Insira um email válido com um domínio (ex: .com)
                </mat-error>
                <mat-error *ngIf="loginForm.get('email')?.hasError('email') && !loginForm.get('email')?.hasError('emailTLD')">
                    Email inválido
                </mat-error>
                <mat-error *ngIf="loginForm.get('email')?.hasError('required') && !loginForm.get('email')?.hasError('emailTLD') && !loginForm.get('email')?.hasError('email')">
                    Este campo é obrigatório
                </mat-error>
            </mat-form-field>

            <!-- Campo Senha -->
            <mat-form-field class="largura-total" appearance="outline">
                <mat-label>Senha</mat-label>
                <span matPrefix>
                    <mat-icon class="input-icon">lock</mat-icon>
                </span>
                <input matInput placeholder="Sua senha" formControlName="senha" [type]="hidePassword ? 'password' : 'text'">
                <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
                    <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                </button>
                <mat-error *ngIf="loginForm.get('senha')?.hasError('required')">
                    Este campo é obrigatório
                </mat-error>
            </mat-form-field>
            <!-- Link Esqueci Minha Senha -->
            <div class="forgot-password">
                <a href="#" (click)="forgotPassword(); $event.preventDefault();">Esqueci minha senha</a>
                <span *ngIf="showForgotInfo" class="not-ready">Funcionalidade ainda não implementada.</span>
            </div>
            <div *ngIf="showLoginError" class="login-error-card">
                <mat-icon>error</mat-icon>
                Não foi possível acessar sua conta. Verifique seu e-mail e senha e tente novamente.
            </div>
            <div class="actions">
                <button 
                  type="submit" 
                  class="primary-action" 
                  [disabled]="!loginForm.valid">
                  <i nz-icon nzType="login" nzTheme="outline"></i>
                  Entrar
                </button>
                
                <button 
                  type="button"
                  class="secondary-action" 
                  (click)="irParaCadastro()">
                  <i nz-icon nzType="user-add" nzTheme="outline"></i>
                  Criar Conta
                </button>
            </div>
        </form>
    </div>
</app-default-login-layout>
