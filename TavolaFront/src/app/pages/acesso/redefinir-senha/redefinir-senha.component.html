<app-default-login-layout title="Redefinir sua Senha">
  <div class="form-section">
    <form [formGroup]="resetForm" class="reset-form" (ngSubmit)="onSubmit()">
      <p class="form-description">
        Crie uma nova senha. Ela deve ter no mínimo 8 caracteres e conter ao menos um caractere especial.
      </p>

      <mat-form-field appearance="outline">
        <mat-label>Nova Senha</mat-label>
        <input matInput formControlName="novaSenha" [type]="hidePassword ? 'password' : 'text'">
        <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
          <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
        </button>
        <mat-error *ngIf="resetForm.get('novaSenha')?.hasError('required')">
          Este campo é obrigatório
        </mat-error>
        <mat-error *ngIf="resetForm.get('novaSenha')?.hasError('minCaracteres')">
          A senha deve ter no mínimo 8 caracteres
        </mat-error>
        <mat-error *ngIf="resetForm.get('novaSenha')?.hasError('semCaractereEspecial')">
          A senha deve conter ao menos um caractere especial
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Confirme sua senha</mat-label>
        <input matInput formControlName="confirmarSenha" [type]="hideConfirmPassword ? 'password' : 'text'">
        <button mat-icon-button matSuffix (click)="hideConfirmPassword = !hideConfirmPassword" type="button">
          <mat-icon>{{hideConfirmPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
        </button>
        <mat-error *ngIf="resetForm.get('confirmarSenha')?.hasError('required')">
          Este campo é obrigatório
        </mat-error>
        <mat-error *ngIf="resetForm.get('confirmarSenha')?.hasError('passwordMismatch')">
          As senhas não coincidem
        </mat-error>
      </mat-form-field>
      
      <div class="actions">
        <button type="submit" class="primary-action" [disabled]="!resetForm.valid || isLoading">
          <i nz-icon nzType="key" nzTheme="outline" *ngIf="!isLoading"></i>
          <mat-icon *ngIf="isLoading" class="spinning">refresh</mat-icon>
          {{ isLoading ? 'Redefinindo...' : 'Redefinir Senha' }}
        </button>
      </div>
    </form>
  </div>
</app-default-login-layout>
