<div class="historico-container">
    <div class="page-header">
      <h1>Minha Linha do Tempo</h1>
      <p>Sua jornada gastronômica através do Tavola, reserva por reserva.</p>
    </div>
  
    <div *ngIf="historicoAgrupado.length === 0" class="sem-reservas">
      <mat-icon>sentiment_dissatisfied</mat-icon>
      <p>Sua linha do tempo ainda não tem histórias para contar.</p>
      <a mat-stroked-button color="primary" routerLink="/home">Fazer a primeira reserva</a>
    </div>
  
    <div *ngIf="historicoAgrupado.length > 0" class="timeline-wrapper">
  
      <div *ngFor="let grupo of historicoAgrupado" class="timeline-group">
        <h2 class="timeline-month">{{ grupo.mesAno }}</h2>
  
        <ul class="timeline">
  
          <li *ngFor="let reserva of grupo.reservas" class="timeline-item">
            
            <div class="timeline-badge">
              <mat-icon>{{ getIconePorStatus(reserva.status) }}</mat-icon>
            </div>
  
            <mat-card class="reserva-card" [ngClass]="'status-border-' + reserva.status.toLowerCase()">
              
              <img mat-card-image 
                   class="restaurante-imagem" 
                   [src]="getImagemUrl(reserva.imagemRestaurante)" 
                   alt="Foto de {{ reserva.nomeRestaurante }}">
              
              <mat-card-header>
                <mat-card-title>{{ reserva.nomeRestaurante }}</mat-card-title>
                <mat-card-subtitle>{{ reserva.enderecoResumido }}</mat-card-subtitle>
              </mat-card-header>
  
              <mat-card-content>
                <div class="info-reserva">
                  <span><mat-icon>event</mat-icon> {{ reserva.data | date:'dd/MM/yyyy' }}</span>
                  <span><mat-icon>schedule</mat-icon> {{ reserva.horario }}</span>
                  <span><mat-icon>group</mat-icon> {{ reserva.quantidadePessoas }} pessoas</span>
                </div>
  
                <div *ngIf="reserva.comentariosPreferenciaReserva" class="comentarios-section">
                  <mat-icon>comment</mat-icon>
                  <div class="comentario-texto">
                    <strong>Suas Preferências:</strong>
                    <p>"{{ reserva.comentariosPreferenciaReserva }}"</p>
                  </div>
                </div>
              </mat-card-content>
              
              <mat-card-actions class="card-actions">
                <button mat-stroked-button (click)="verRestaurante(reserva.idRestaurante)">Ver Restaurante</button>
                <button mat-flat-button color="primary" (click)="reservarNovamente(reserva.idRestaurante)">Reservar Novamente</button>
              </mat-card-actions>
            </mat-card>
          </li>
        </ul>
      </div>
    </div>
  </div>