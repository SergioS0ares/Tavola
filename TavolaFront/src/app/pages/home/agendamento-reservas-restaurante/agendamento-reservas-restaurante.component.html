<div class="container-rounded">
  <!-- Breadcrumb -->
  <nz-breadcrumb class="breadcrumb">
    <nz-breadcrumb-item>
      <a routerLink="/home">
        <i nz-icon nzType="home" nzTheme="outline"></i>
      </a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a routerLink="/restaurantes">Restaurantes</a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>{{ restaurante?.nome }}</nz-breadcrumb-item>
  </nz-breadcrumb>

  <!-- Cabeçalho do Restaurante -->
  <div class="restaurant-header">
    <div class="title-row">
      <h1 class="restaurant-title">{{ restaurante?.nome }}</h1>
      <button 
        nz-button 
        nzType="default" 
        nzShape="circle" 
        class="favorite-button" 
        (click)="toggleFavorite()" 
        nz-tooltip 
        [nzTooltipTitle]="isFavorite ? 'Remover dos favoritos' : 'Adicionar aos favoritos'"
      >
        <i nz-icon [nzType]="'heart'" [nzTheme]="isFavorite ? 'fill' : 'outline'"></i>
      </button>
    </div>
    
    <div class="restaurant-info">
      <div class="info-item">
        <i nz-icon nzType="environment" nzTheme="outline"></i>
        <span>{{ restaurante?.endereco }}, {{ restaurante?.cidade }} - {{ restaurante?.estado }}</span>
      </div>
      
      <div class="info-item">
        <i nz-icon nzType="flag" nzTheme="outline"></i>
        <span>{{ restaurante?.tipoCozinha }} · Preço médio {{ restaurante?.precoMedio | currency:'BRL' }}</span>
      </div>
      
      <div class="info-item rating">
        <nz-rate [ngModel]="restaurante?.avaliacao" nzDisabled [nzCount]="5"></nz-rate>
        <span class="rating-value">{{ restaurante?.avaliacao }}</span>
        <span class="reviews-count" *ngIf="restaurante?.totalAvaliacoes">({{ restaurante?.totalAvaliacoes }} avaliações)</span>
      </div>
    </div>
  </div>

  <!-- Galeria de Fotos com NzImageModule -->
  <div class="photo-gallery">
    <nz-image-group>
      <div class="gallery-grid">
        <!-- Foto Principal (Grande) -->
        <div class="main-photo">
          <img nz-image [nzSrc]="restaurantImages[0]" alt="Interior do restaurante">
        </div>
        
        <!-- Foto Média -->
        <div class="medium-photo">
          <img nz-image [nzSrc]="restaurantImages[1]" alt="Prato do restaurante">
        </div>
        
        <!-- Foto Pequena Superior -->
        <div class="small-photo-top">
          <img nz-image [nzSrc]="restaurantImages[2]" alt="Detalhe do restaurante">
        </div>
        
        <!-- Foto Pequena Inferior -->
        <div class="small-photo-bottom">
          <img nz-image [nzSrc]="restaurantImages[3]" alt="Ambiente do restaurante">
        </div>
        
        <!-- Botão Ver Mais Fotos -->
        <div class="more-photos" (click)="openGallery()">
          <img [src]="restaurantImages[4]" alt="Mais fotos">
          <div class="more-overlay">
            <span>Veja outras {{ totalPhotos }} fotos</span>
          </div>
        </div>
      </div>
    </nz-image-group>
  </div>

  <!-- Abas de Navegação -->
  <div #tabsContainer class="navigation-tabs" [class.fixed]="tabFixo">
    <mat-tab-group (selectedIndexChange)="onTabChange($event)" [selectedIndex]="activeTabIndex">
      <mat-tab label="Sobre"></mat-tab>
      <mat-tab label="Menu"></mat-tab>
      <mat-tab label="Avaliações"></mat-tab>
    </mat-tab-group>
  </div>

  <!-- Área de Conteúdo -->
  <div class="content-area">
    <!-- Coluna de Conteúdo -->
    <div class="content-column">
      <!-- Conteúdo da aba Sobre -->
      <div *ngIf="activeTabIndex === 0" class="sobre-content">
        <!-- Descrição do Restaurante -->
        <div class="descricao-section">
          <h2>Sobre o restaurante</h2>
          <p>{{ restaurante?.descricao }}</p>
        </div>
        
        <!-- Localização -->
        <div class="localizacao-section">
          <h2>Localização</h2>
          <div class="mapa-container">
            <google-map [center]="center" [zoom]="zoom" height="300px" width="100%">
              <map-marker [position]="markerPosition" [options]="markerOptions"></map-marker>
            </google-map>
          </div>
          <div class="endereco-completo">
            <div class="endereco-copy">
              <p> <i nz-icon nzType="environment" nzTheme="outline"></i> {{ restaurante?.endereco }}, {{ restaurante?.cidade }} - {{ restaurante?.estado }}, {{ restaurante?.cep }}</p>
              <button 
                nz-button 
                nzType="text" 
                class="copy-button" 
                (click)="copiarEndereco()" 
                nz-tooltip 
                [nzTooltipTitle]="copiado ? 'Copiado!' : 'Copiar endereço'"
              >
                <nz-icon [nzType]="copiado ? 'check' : 'copy'" nzTheme="outline"></nz-icon>
              </button>
            </div>
            <button mat-stroked-button color="primary">
              <mat-icon>directions</mat-icon>
              Como chegar
            </button>
          </div>
        </div>
        
        <!-- Mais Detalhes -->
        <div class="mais-detalhes-section">
          <h2>Mais detalhes</h2>
          
          <!-- Horários de Funcionamento -->
          <div class="horarios-section">
            <h3>Horário de funcionamento</h3>
            <div class="horarios-lista">
              <div *ngFor="let horario of horariosFuncionamento.slice(0, 3)" class="horario-item">
                <span class="dia">{{ horario.dia }}</span>
                <span class="horas">{{ horario.abertura }} - {{ horario.fechamento }}</span>
              </div>
            </div>
            <button mat-button color="primary" class="mostrar-mais" (click)="openHorarios()">
              Mostre mais
            </button>
          </div>
          
          <!-- Recursos e Serviços -->
          <div class="recursos-section">
            <h3>Recursos e serviços</h3>
            <div class="recursos-lista">
              <div *ngFor="let recurso of recursos" class="recurso-item">
                <mat-icon>{{ recurso.icone }}</mat-icon>
                <span>{{ recurso.nome }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Conteúdo da aba Menu -->
      <div *ngIf="activeTabIndex === 1" class="menu-content">
        <div class="menu-intro">
          <h2>Experimente este menu</h2>
          <p>Explore a oferta gastronômica deste restaurante e deixe-se inspirar.</p>
          
          <div class="menu-info">
            <div class="opcoes-dieteticas" (click)="openDietOptions()">
              <i nz-icon nzType="check-circle" nzTheme="outline"></i>
              <div>
                <span>Opções dietéticas</span>
                <p>{{ dietOptions.join(', ') }}</p>
              </div>
              <i nz-icon nzType="right" nzTheme="outline"></i>
            </div>
          </div>
        </div>
        
        <!-- Categorias de navegação -->
        <div class="categorias-nav" [class.fixed]="categoriasFixas">
          <div class="categorias-scroll">
            <button 
              *ngFor="let categoria of categorias" 
              class="categoria-btn" 
              [class.active]="categoriaAtiva === categoria"
              (click)="scrollToCategoria(categoria)"
            >
              {{ categoria }}
            </button>
          </div>
        </div>
        
        <!-- Seções de categorias -->
        <div class="categorias-container">
          <div *ngFor="let categoria of categorias" class="categoria-section" [id]="'categoria-' + categoria.toLowerCase().replace(' ', '-')">
            <h3 class="categoria-titulo">{{ categoria }}</h3>
            
            <div class="itens-lista">
              <div *ngFor="let item of getItensPorCategoria(categoria)" class="item-card">
                <div class="item-content">
                  <div class="item-image">
                    <img [src]="item.imagem || 'assets/jpg/Comida.jpg'" [alt]="item.nome">
                  </div>
                  <div class="item-info">
                    <h4 class="item-nome">{{ item.nome }}</h4>
                    <p class="item-descricao">{{ item.descricao }}</p>
                    <div class="item-tags" *ngIf="item.tags && item.tags.length > 0">
                      <span *ngFor="let tag of item.tags" class="tag-chip">{{ tag }}</span>
                    </div>
                  </div>
                  <div class="item-preco">
                    {{ item.preco | currency:'BRL' }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Conteúdo da aba Avaliações -->
      <div *ngIf="activeTabIndex === 2" class="avaliacoes-content">
        <h2>Avaliações em breve</h2>
        <p>O conteúdo das avaliações será implementado quando o endpoint estiver pronto.</p>
      </div>
    </div>
    
    <!-- Coluna de Reserva -->
    <div class="booking-column">
      <nz-card class="booking-card">
        <nz-card-meta [nzTitle]="bookingTitle" [nzDescription]="bookingDescription"></nz-card-meta>
        <ng-template #bookingTitle>
          <h2 class="booking-title">Reserve uma mesa</h2>
        </ng-template>
        <ng-template #bookingDescription>
          <p class="free-text">Grátis</p>
        </ng-template>
        
        <!-- Formulário de Reserva -->
        <div class="booking-form">
          <!-- Data -->
          <nz-form-item>
            <nz-date-picker nzPlaceHolder="Selecione a data" class="form-control"></nz-date-picker>
          </nz-form-item>
          
          <!-- Horário -->
          <nz-form-item>
            <nz-select nzPlaceHolder="Selecione o horário" class="form-control">
              <nz-option nzValue="12:00" nzLabel="12:00"></nz-option>
              <nz-option nzValue="12:30" nzLabel="12:30"></nz-option>
              <nz-option nzValue="13:00" nzLabel="13:00"></nz-option>
              <nz-option nzValue="13:30" nzLabel="13:30"></nz-option>
              <nz-option nzValue="19:00" nzLabel="19:00"></nz-option>
              <nz-option nzValue="19:30" nzLabel="19:30"></nz-option>
              <nz-option nzValue="20:00" nzLabel="20:00"></nz-option>
              <nz-option nzValue="20:30" nzLabel="20:30"></nz-option>
            </nz-select>
          </nz-form-item>
          
          <!-- Pessoas -->
          <nz-form-item>
            <nz-select nzPlaceHolder="Número de pessoas" class="form-control">
              <nz-option nzValue="1" nzLabel="1 pessoa"></nz-option>
              <nz-option nzValue="2" nzLabel="2 pessoas"></nz-option>
              <nz-option nzValue="3" nzLabel="3 pessoas"></nz-option>
              <nz-option nzValue="4" nzLabel="4 pessoas"></nz-option>
              <nz-option nzValue="5" nzLabel="5 pessoas"></nz-option>
              <nz-option nzValue="6" nzLabel="6 pessoas"></nz-option>
              <nz-option nzValue="7" nzLabel="7 pessoas"></nz-option>
              <nz-option nzValue="8" nzLabel="8+ pessoas"></nz-option>
            </nz-select>
          </nz-form-item>
          
          <!-- Botão de Busca -->
          <button nz-button nzType="primary" class="search-button">
            Buscar mesa
          </button>
        </div>
      </nz-card>
    </div>
  </div>
  
  <!-- Botão de voltar ao topo -->
  <button *ngIf="tabFixo" mat-fab color="primary" class="back-to-top" (click)="scrollToTop()">
    <mat-icon>arrow_upward</mat-icon>
  </button>
  
  <!-- Modal de Galeria Completa -->
  <nz-modal
    [(nzVisible)]="isGalleryVisible"
    nzTitle="Galeria de Fotos"
    [nzFooter]="null"
    (nzOnCancel)="closeGallery()"
    nzWidth="80%"
    nzCentered
  >
    <ng-container *nzModalContent>
      <div class="full-gallery">
        <nz-image-group>
          <div class="gallery-grid-modal">
            <div class="gallery-item" *ngFor="let img of allImages">
              <img nz-image [nzSrc]="img" alt="Foto do restaurante">
            </div>
          </div>
        </nz-image-group>
      </div>
    </ng-container>
  </nz-modal>
  
  <!-- Modal de Horários -->
  <nz-modal
    [(nzVisible)]="isHorariosVisible"
    nzTitle="Horário de funcionamento"
    [nzFooter]="null"
    (nzOnCancel)="closeHorarios()"
    nzWidth="500px"
    nzCentered
  >
    <ng-container *nzModalContent>
      <p class="horarios-descricao">Verifique a disponibilidade e reserve já a sua mesa para garantir o seu lugar.</p>
      <div class="horarios-lista-completa">
        <div *ngFor="let horario of horariosFuncionamento" class="horario-item">
          <span class="dia">{{ horario.dia }}</span>
          <span class="horas">{{ horario.abertura }} - {{ horario.fechamento }}</span>
        </div>
      </div>
    </ng-container>
  </nz-modal>
</div>
